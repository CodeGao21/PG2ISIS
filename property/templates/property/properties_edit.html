{% extends 'core/base.html' %}

{% block title %}Modificar Propiedad{% endblock %}

{% block content %}
<div class="mt-8 bg-white p-8 rounded-xl shadow-lg max-w-md mx-auto pt-4 border border-blue-900">
    <h1 class="text-3xl text-blue-900 mb-6">Modificar Propiedad</h1>

    <form method="post" action=".">
        {% csrf_token %}

        <!-- Nombre -->
        <div class="mb-4">
            <label for="name" class="block text-sm font-bold text-gray-700 mb-2">Nombre</label>
            <input type="text" id="name" name="name" class="w-full p-2 border border-gray-300 rounded" value="{{ form.instance.name }}" required>
        </div>

        <!-- Sociedad -->
        <div class="mb-4">
            <label for="society" class="block text-sm font-bold text-gray-700 mb-2">Sociedad</label>
            <select id="society" name="society" class="w-full p-2 border border-gray-300 rounded">
                <option value="">---------</option>
                {% for society in societies %}
                    <option value="{{ society.id }}" {% if society.id == form.instance.society.id %}selected{% endif %}>
                        {{ society.name }}
                    </option>
                {% endfor %}
            </select>
        </div>

        <!-- Descripción -->
        <div class="mb-4">
            <label for="description" class="block text-sm font-bold text-gray-700 mb-2">Descripción </label>
            <textarea id="description" name="description" class="w-full p-2 border border-gray-300 rounded">{{ form.instance.description }}</textarea>
        </div>

    <!-- Condición -->
    <div class="mb-4">
        <label for="condition" class="block text-sm font-bold text-gray-700 mb-2">Condición</label>
        <select id="condition" name="condition" class="w-full p-2 border border-gray-300 rounded" required>
            {% for choice in form.fields.condition.choices %}
                <option value="{{ choice.0 }}" {% if choice.0 == form.instance.condition %}selected{% endif %}>{{ choice.1 }}</option>
            {% endfor %}
        </select>
    </div>

        <!-- Administrador-->
        <div class="mb-4">
            <label for="admin" class="block text-sm font-bold text-gray-700 mb-2">Administrador</label>
            <input type="text" id="admin" name="admin" class="w-full p-2 border border-gray-300 rounded" {% if form.instance.admin is not None %} value="{{ form.instance.admin }}" {% endif %}>
        </div>
    
        <div class="mb-4">
            <label for="adminemail" class="block text-sm font-bold text-gray-700 mb-2">Correo Electrónico Administrador </label>
            <input type="email" id="adminemail" name="adminemail" class="w-full p-2 border border-gray-300 rounded" {% if form.instance.adminemail is not None %} value="{{ form.instance.adminemail }}" {% endif %}>
        </div>
    
        <div class="mb-4">
            <label for="adminphone" class="block text-sm font-bold text-gray-700 mb-2">Teléfono Administrador</label>
            <input type="text" id="adminphone" name="adminphone" class="w-full p-2 border border-gray-300 rounded" {% if form.instance.adminphone is not None %} value="{{ form.instance.adminphone }}" {% endif %} >
        </div>

    <!-- Estacionamientos -->
    <div class="mb-4">
        <label for="parkings" class="block text-sm font-bold text-gray-700 mb-2">Estacionamientos</label>
        <input type="number" id="parkings" name="parkings" class="w-full p-2 border border-gray-300 rounded" value="{{ form.instance.parkings }}" required>
    </div>

    <!-- Área -->
    <div class="mb-4">
        <label for="area1" class="block text-sm font-bold text-gray-700 mb-2">Área (m²)</label>
        <input type="text" id="area1" name="area1" class="w-full p-2 border border-gray-300 rounded" value="{{ form.instance.area1 }}" required>
    </div>

    <!-- Dirección -->
    <div class="mb-4">
        <label for="address" class="block text-sm font-bold text-gray-700 mb-2">Dirección</label>
        <input type="text" id="address" name="address" class="w-full p-2 border border-gray-300 rounded" {% if form.instance.address is not None %} value="{{ form.instance.address }}" {% endif %}>
    </div>


    <!-- Precio de Alquiler-->
    <div class="mb-4">
        <label for="rentprice" class="block text-sm font-bold text-gray-700 mb-2">Precio de Alquiler</label>
        <input type="text" id="rentprice" name="rentprice" class="w-full p-2 border border-gray-300 rounded" value="{{ form.instance.rentprice }}" required>
    </div>

    <!-- Precio de Mantenimiento-->
    <div class="mb-4">
        <label for="mainteinprice" class="block text-sm font-bold text-gray-700 mb-2">Precio de Mantenimiento</label>
        <input type="text" id="mainteinprice" name="mainteinprice" class="w-full p-2 border border-gray-300 rounded" value="{{ form.instance.mainteinprice }}" required>
    </div>

    <!-- Descripción del Mantenimiento -->
    <div class="mb-4">
        <label for="maindescrp" class="block text-sm font-bold text-gray-700 mb-2">Descripción del Mantenimiento </label>
        <textarea id="maindescrp" name="maindescrp" class="w-full p-2 border border-gray-300 rounded">{{ form.instance.maindescrp }}</textarea>
    </div>

    <!-- Estado -->
    <div class="mb-4">
        <label for="state" class="block text-sm font-bold text-gray-700 mb-2">Estado</label>
        <select id="state" name="state" class="w-full p-2 border border-gray-300 rounded" required oninput="toggleAdditionalOptions()">
            {% for choice in form.fields.state.choices %}
                <option value="{{ choice.0 }}" {% if choice.0 == form.instance.state %}selected{% endif %}>{{ choice.1 }}</option>
            {% endfor %}
        </select>
    </div>


        <!-- Additional options -->
        <div id="additionalOptions" style="display: {% if form.instance.currentlease %}block{% else %}none{% endif %}">

        <!-- Inquilino -->
        <div class="mb-4">
            <label for="currentlease" class="block text-sm font-bold text-gray-700 mb-2">Inquilino</label>
            <select id="currentlease" name="currentlease" class="w-full p-2 border border-gray-300 rounded">
                <option value="">---------</option>
                {% for client in clients %}
                    <option value="{{ client.id }}" 
                        {% if form.instance.currentlease and client.id == form.instance.currentlease.id %}selected{% endif %}>
                        {{ client.commercialname }}
                    </option>
                {% endfor %}
            </select>
        </div>

            <!-- Fceha Último Incremento -->
            <div class="mb-4">
                <label for="lastincrease" class="block text-sm font-bold text-gray-700 mb-2">Fecha Último Incremento (Si es nuevo contrato dejar fecha actual)</label>
                <input type="date" id="lastincrease" name="lastincrease" class="w-full p-2 border border-gray-300 rounded" value="{% if form.instance.lastincrease %}{{ form.instance.lastincrease|date:'Y-m-d' }}{% endif %}">
            </div>


            <!-- Pago Mantenimiento -->
            <div class="mb-4">
                <label for="pay" class="block text-sm font-bold text-gray-700 mb-2">Pago de Mantenimiento </label>
                <select id="pay" name="pay" class="w-full p-2 border border-gray-300 rounded">
                    {% for choice in form.fields.pay.choices %}
                        <option value="{{ choice.0 }}" {% if choice.0 == form.instance.pay %}selected{% endif %}>{{ choice.1 }}</option>
                    {% endfor %}
                </select>
            </div>


                <!-- Poliza -->
            <div class="mb-4">
                <label for="poliza" class="block text-sm font-bold text-gray-700 mb-2">Póliza</label>
                <select id="poliza" name="poliza" class="w-full p-2 border border-gray-300 rounded">
                    {% for choice in form.fields.poliza.choices %}
                        <option value="{{ choice.0 }}" {% if choice.0 == form.instance.poliza %}selected{% endif %}>{{ choice.1 }}</option>
                    {% endfor %}
                </select>
            </div>

            <!-- Depósito -->
            <div class="mb-4">
                <label for="deposit" class="block text-sm font-bold text-gray-700 mb-2">Depósito </label>
                <input type="text" id="deposit" name="deposit" class="w-full p-2 border border-gray-300 rounded" value="{{ form.instance.deposito }}">
            </div>

            <!-- Inicio del arrendamiento -->
            <div class="mb-4">
                <label for="leasestart" class="block text-sm font-bold text-gray-700 mb-2">Inicio del Contrato</label>
                <input type="date" id="leasestart" name="leasestart" class="w-full p-2 border border-gray-300 rounded" value="{% if form.instance.leasestart %}{{ form.instance.leasestart|date:'Y-m-d' }}{% endif %}">
            </div>

            <!-- Fin del arrendamiento -->
            <div class="mb-4">
                <label for="leasend" class="block text-sm font-bold text-gray-700 mb-2">Fin del Contrato</label>
                <input type="date" id="leasend" name="leasend" class="w-full p-2 border border-gray-300 rounded" value="{% if form.instance.leasend %}{{ form.instance.leasend|date:'Y-m-d' }}{% endif %}">
            </div>

            <!-- Incremento -->
            <div class="mb-4">
                <label for="increase" class="block text-sm font-bold text-gray-700 mb-2">Incremento</label>
                <input type="text" id="increase" name="increase" class="w-full p-2 border border-gray-300 rounded" value="{{ form.instance.increase }}">
            </div>


            <!-- Mes de Renovación -->
            <div class="mb-4">
                <label for="renov" class="block text-sm font-bold text-gray-700 mb-2">Mes de Renovación </label>
                <select id="renov" name="renov" class="w-full p-2 border border-gray-300 rounded">
                    {% for choice in form.fields.renov.choices %}
                        <option value="{{ choice.0 }}" {% if choice.0 == form.instance.renov %}selected{% endif %}>{{ choice.1 }}</option>
                    {% endfor %}
                </select>
            </div>

            <!-- Notificar Renovación -->
            <div class="mb-4">
                <label for="notifyrenew" class="block text-sm font-bold text-gray-700 mb-2">Días Notificar Renovación </label>
                <input type="number" id="notifyrenew" name="notifyrenew" class="w-full p-2 border border-gray-300 rounded" value="{{ form.instance.notifyrenew }}">
            </div>
        </div>

        <!-- Botones de envío y volver -->
        <div class="flex items-center justify-center mt-4">
            <button class="py-2 px-4 bg-blue-900 hover:bg-blue-700 text-sm text-white rounded-full" type="submit">Modificar</button>
        </div>
    </form>
    <script>
        function toggleAdditionalOptions() {
            var stateField = document.getElementById('state');
            var additionalOptionsDiv = document.getElementById('additionalOptions');
        
            if (stateField.value === 'Ocupado') {
                additionalOptionsDiv.style.display = 'block';
            } else {
                additionalOptionsDiv.style.display = 'none';
            }
        }
        </script>
        
</div>


{% endblock %}
